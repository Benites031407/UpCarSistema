# Production Environment Configuration for UpCar-Aspiradores
# Copy this file to .env.prod and update with your actual values

# =============================================================================
# CORE APPLICATION CONFIGURATION
# =============================================================================

# Node.js Environment
NODE_ENV=production
PORT=3001

# =============================================================================
# DATABASE CONFIGURATION
# =============================================================================

# PostgreSQL Database
DB_HOST=postgres
DB_PORT=5432
DB_NAME=upcar_aspiradores
DB_USER=postgres
DB_PASSWORD=your-secure-database-password-change-this
DB_SSL=false
DB_POOL_MIN=2
DB_POOL_MAX=10
DB_CONNECTION_TIMEOUT=60000
DB_IDLE_TIMEOUT=30000

# Database Backup Configuration
BACKUP_RETENTION_DAYS=30
BACKUP_SCHEDULE="0 2 * * *"  # Daily at 2 AM

# =============================================================================
# CACHE CONFIGURATION
# =============================================================================

# Redis Configuration
REDIS_HOST=redis
REDIS_PORT=6379
REDIS_PASSWORD=your-secure-redis-password-change-this
REDIS_DB=0
REDIS_KEY_PREFIX=upcar_aspiradores:
REDIS_TTL=3600

# =============================================================================
# AUTHENTICATION & SECURITY
# =============================================================================

# JWT Configuration
JWT_SECRET=your-super-secure-jwt-secret-key-at-least-32-characters-long-minimum-64-chars-recommended
JWT_EXPIRES_IN=1h
JWT_REFRESH_EXPIRES_IN=7d
JWT_ISSUER=upcar-aspiradores
JWT_AUDIENCE=upcar-aspiradores-users

# Google OAuth Configuration
GOOGLE_CLIENT_ID=your-google-client-id
GOOGLE_CLIENT_SECRET=your-google-client-secret
GOOGLE_CALLBACK_URL=https://yourdomain.com/auth/google/callback

# Security Configuration
SECURITY_AUDIT_LEVEL=HIGH
MAX_CONCURRENT_SESSIONS=3
SESSION_TIMEOUT_HOURS=8
INACTIVITY_TIMEOUT_HOURS=1
ADMIN_WHITELIST_IPS=your.admin.ip.address,another.admin.ip
PASSWORD_MIN_LENGTH=8
PASSWORD_REQUIRE_SPECIAL=true
PASSWORD_REQUIRE_NUMBERS=true
PASSWORD_REQUIRE_UPPERCASE=true

# Security Features
ENABLE_AUDIT_LOGGING=true
ENABLE_SESSION_SECURITY=true
ENABLE_IP_WHITELIST=false
REQUIRE_REAUTH_FOR_SENSITIVE=true
ENABLE_RATE_LIMITING=true
ENABLE_CSRF_PROTECTION=true
ENABLE_HELMET_SECURITY=true

# =============================================================================
# RATE LIMITING CONFIGURATION
# =============================================================================

# API Rate Limits (requests per minute)
API_RATE_LIMIT=60
AUTH_RATE_LIMIT=5
PAYMENT_RATE_LIMIT=3
ADMIN_RATE_LIMIT=100
MACHINE_ACTIVATION_RATE_LIMIT=10

# Rate Limiting Windows (in minutes)
RATE_LIMIT_WINDOW=1
AUTH_RATE_LIMIT_WINDOW=15
PAYMENT_RATE_LIMIT_WINDOW=5

# =============================================================================
# APPLICATION URLS & CORS
# =============================================================================

# Application URLs
CORS_ORIGIN=https://yourdomain.com
FRONTEND_URL=https://yourdomain.com
VITE_API_URL=https://yourdomain.com/api
API_BASE_URL=https://yourdomain.com/api

# Additional CORS Origins (comma-separated)
ADDITIONAL_CORS_ORIGINS=https://admin.yourdomain.com,https://staging.yourdomain.com

# =============================================================================
# PAYMENT GATEWAY CONFIGURATION
# =============================================================================

# PIX Payment Configuration (Mercado Pago)
PIX_GATEWAY_URL=https://api.mercadopago.com
PIX_ACCESS_TOKEN=your-production-pix-access-token
PIX_PUBLIC_KEY=your-pix-public-key
PIX_WEBHOOK_SECRET=your-pix-webhook-secret
PIX_NOTIFICATION_URL=https://yourdomain.com/api/payments/pix/webhook

# Payment Configuration
PAYMENT_TIMEOUT_MINUTES=15
PAYMENT_RETRY_ATTEMPTS=3
PAYMENT_CURRENCY=BRL
MINIMUM_PAYMENT_AMOUNT=1.00
MAXIMUM_PAYMENT_AMOUNT=1000.00

# =============================================================================
# NOTIFICATION SERVICES
# =============================================================================

# WhatsApp Business API Configuration
WHATSAPP_API_URL=https://graph.facebook.com/v18.0
WHATSAPP_ACCESS_TOKEN=your-whatsapp-business-access-token
WHATSAPP_PHONE_NUMBER_ID=your-whatsapp-phone-number-id
WHATSAPP_WEBHOOK_VERIFY_TOKEN=your-whatsapp-webhook-verify-token

# Notification Configuration
NOTIFICATION_RETRY_ATTEMPTS=3
NOTIFICATION_RETRY_DELAY=5000
NOTIFICATION_RATE_LIMIT=10
NOTIFICATION_RATE_LIMIT_WINDOW=60

# Email Configuration (if using email notifications)
SMTP_HOST=smtp.yourdomain.com
SMTP_PORT=587
SMTP_SECURE=true
SMTP_USER=noreply@yourdomain.com
SMTP_PASSWORD=your-smtp-password
EMAIL_FROM=UpCar Aspiradores <noreply@yourdomain.com>

# =============================================================================
# IOT & MQTT CONFIGURATION
# =============================================================================

# MQTT Broker Configuration
MQTT_BROKER_URL=mqtt://mosquitto:1883
MQTT_USERNAME=mqtt_user
MQTT_PASSWORD=your-secure-mqtt-password
MQTT_CLIENT_ID=upcar-aspiradores-backend
MQTT_KEEP_ALIVE=60
MQTT_RECONNECT_PERIOD=1000
MQTT_CONNECT_TIMEOUT=30000

# IoT Device Configuration
IOT_HEARTBEAT_INTERVAL=60000
IOT_OFFLINE_TIMEOUT=300000
IOT_COMMAND_TIMEOUT=30000
IOT_MAX_RETRY_ATTEMPTS=3

# =============================================================================
# ADMIN CONFIGURATION
# =============================================================================

# Admin User Configuration
ADMIN_EMAIL=admin@yourdomain.com
ADMIN_PHONE=+5511999999999
ADMIN_NAME=System Administrator

# Admin Dashboard Configuration
ADMIN_SESSION_TIMEOUT=4h
ADMIN_REQUIRE_2FA=true
ADMIN_IP_WHITELIST=true

# =============================================================================
# LOGGING CONFIGURATION
# =============================================================================

# Logging Configuration
LOG_LEVEL=info
LOG_FORMAT=json
LOG_MAX_SIZE=10m
LOG_MAX_FILES=5
LOG_DATE_PATTERN=YYYY-MM-DD

# Log Destinations
LOG_TO_FILE=true
LOG_TO_CONSOLE=true
LOG_TO_SYSLOG=false

# Audit Logging
AUDIT_LOG_ENABLED=true
AUDIT_LOG_LEVEL=info
AUDIT_LOG_RETENTION_DAYS=90

# =============================================================================
# MONITORING & METRICS
# =============================================================================

# Monitoring Configuration
ENABLE_METRICS=true
METRICS_PORT=9464
METRICS_PATH=/metrics

# Health Check Configuration
HEALTH_CHECK_ENABLED=true
HEALTH_CHECK_PATH=/health
HEALTH_CHECK_TIMEOUT=5000

# Grafana Configuration
GRAFANA_ADMIN_PASSWORD=your-secure-grafana-password
GRAFANA_ADMIN_USER=admin

# =============================================================================
# SSL/TLS CONFIGURATION
# =============================================================================

# SSL Configuration
SSL_ENABLED=true
SSL_CERT_PATH=/etc/nginx/ssl/cert.pem
SSL_KEY_PATH=/etc/nginx/ssl/key.pem
SSL_CA_PATH=/etc/nginx/ssl/ca.pem

# TLS Configuration
TLS_MIN_VERSION=1.2
TLS_CIPHER_SUITES=ECDHE-RSA-AES256-GCM-SHA512:DHE-RSA-AES256-GCM-SHA512

# =============================================================================
# PERFORMANCE CONFIGURATION
# =============================================================================

# Application Performance
MAX_REQUEST_SIZE=10mb
REQUEST_TIMEOUT=30000
KEEP_ALIVE_TIMEOUT=5000

# Database Performance
DB_QUERY_TIMEOUT=30000
DB_STATEMENT_TIMEOUT=60000

# Cache Performance
CACHE_TTL=300
CACHE_MAX_SIZE=100mb

# =============================================================================
# FEATURE FLAGS
# =============================================================================

# Feature Flags
ENABLE_SUBSCRIPTION_FEATURE=true
ENABLE_MAINTENANCE_MODE=false
ENABLE_DEBUG_MODE=false
ENABLE_ANALYTICS=true
ENABLE_A_B_TESTING=false

# Maintenance Mode
MAINTENANCE_MODE_MESSAGE=System is under maintenance. Please try again later.
MAINTENANCE_MODE_ALLOWED_IPS=your.admin.ip.address

# =============================================================================
# EXTERNAL SERVICES (OPTIONAL)
# =============================================================================

# External Database (if using external PostgreSQL)
# EXTERNAL_DATABASE_URL=postgresql://user:pass@external-db.yourdomain.com:5432/dbname

# External Redis (if using external Redis)
# EXTERNAL_REDIS_URL=redis://user:pass@external-redis.yourdomain.com:6379

# External MQTT Broker (if using external broker)
# EXTERNAL_MQTT_BROKER=mqtt://external-broker.yourdomain.com:1883

# CDN Configuration (if using CDN)
# CDN_URL=https://cdn.yourdomain.com
# CDN_API_KEY=your-cdn-api-key

# =============================================================================
# DEVELOPMENT & TESTING (REMOVE IN PRODUCTION)
# =============================================================================

# Development Configuration (REMOVE THESE IN PRODUCTION)
# ENABLE_SWAGGER_DOCS=false
# ENABLE_CORS_ALL_ORIGINS=false
# ENABLE_REQUEST_LOGGING=false
# MOCK_PAYMENT_GATEWAY=false
# MOCK_WHATSAPP_API=false

# =============================================================================
# ENVIRONMENT VALIDATION
# =============================================================================

# Environment Validation
VALIDATE_ENV_ON_STARTUP=true
REQUIRED_ENV_VARS=DB_PASSWORD,REDIS_PASSWORD,JWT_SECRET,PIX_ACCESS_TOKEN,WHATSAPP_ACCESS_TOKEN

# =============================================================================
# NOTES
# =============================================================================

# IMPORTANT SECURITY NOTES:
# 1. Change ALL default passwords and secrets
# 2. Use strong, unique passwords for all services
# 3. Enable SSL/TLS for all external communications
# 4. Regularly rotate secrets and certificates
# 5. Monitor logs for suspicious activity
# 6. Keep all dependencies updated
# 7. Use environment-specific configurations
# 8. Never commit secrets to version control
# 9. Use proper firewall rules
# 10. Enable audit logging for compliance

# PERFORMANCE NOTES:
# 1. Adjust pool sizes based on expected load
# 2. Monitor resource usage and scale accordingly
# 3. Use caching strategically
# 4. Optimize database queries
# 5. Configure proper timeouts
# 6. Use compression for large responses
# 7. Implement proper rate limiting
# 8. Monitor application metrics

# BACKUP NOTES:
# 1. Test backup and restore procedures regularly
# 2. Store backups in multiple locations
# 3. Encrypt sensitive backup data
# 4. Document recovery procedures
# 5. Monitor backup success/failure